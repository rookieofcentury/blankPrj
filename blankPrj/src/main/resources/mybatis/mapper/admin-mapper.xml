<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="adminMapper">

	<!-- 관리자 로그인 -->
	<select id="login" resultType="AdminVo">
		SELECT NO, ID AS ADMIN_ID, PWD AS ADMIN_PWD
		FROM ADMIN
		WHERE ID = #{adminId}
		AND PWD = #{adminPwd}
	</select>

	<!-- 공지사항 전체 글 카운드 -->
	<select id="listCount" resultType="int">
		SELECT COUNT(*)
		FROM NOTICE
	</select>
	
	<!-- 공지사항 목록 조회 -->
	<select id="selectList" resultType="NoticeVo">
		SELECT N.NO, N.TITLE, CONCAT(SUBSTR(CONTENT, 1, 28),'...') AS CONTENT, SUBSTR(WRITE_DATE, 1, 8) AS WRITE_DATE, N.DELETE_YN, A.ID AS ADMIN_NO
		FROM NOTICE N
		INNER JOIN ADMIN A
		ON A.NO = N.ADMIN_NO
		<if test=" keyword != null and keyword != '' ">
			WHERE ${category} LIKE '%${keyword}%'
		</if>
		ORDER BY NO DESC
	</select>
	
	<!-- 공지사항 작성 -->
	<insert id="noticeWrite">
		INSERT INTO NOTICE
		(
			NO,
			ADMIN_NO,
			TITLE,
			CONTENT,
			WRITE_DATE
		)
		VALUES
		(
			SEQ_NOTICE_NO.NEXTVAL,
			#{adminNo},
			#{title},
			#{content},
			SYSDATE
		)
	</insert>
	
	<!-- 공지사항 상세조회 -->
	<select id="selectOne" resultType="NoticeVo">
		SELECT N.NO, A.ID AS ADMIN_NO, N.TITLE, N.CONTENT, N.FIXE_YN, SUBSTR(WRITE_DATE, 1, 8) AS WRITE_DATE, N.DELETE_YN
		FROM NOTICE N
		INNER JOIN ADMIN A
		ON A.NO = N.ADMIN_NO
		WHERE N.NO = #{no}
	</select>
	
	<update id="updateNotice">
		UPDATE NOTICE SET WRITE_DATE = SYSDATE, TITLE = #{title}, CONTENT = #{content} WHERE NO = #{no}
	</update>
	
</mapper>








